<!--IF NOT MOBILE-->

<ng-container *ngIf="isMobile != true">

  <ng-container *ngIf="isLoaded == false">
    <br />
    <br />
    <br />
    <br />
    <mat-spinner style="margin: auto"></mat-spinner>
  </ng-container>

  <ng-container *ngIf="isLoaded == true">


    <mat-tab-group class="mat-elevation-z4" (selectedTabChange)="loadTab($event)">

      <mat-tab>

        <ng-template mat-tab-label>

          <mat-icon>auto_awesome_mosaic</mat-icon>

          Inventory Gallery

        </ng-template>

        <mat-toolbar color="primary" class="mat-elevation-z22" style="z-index: 100;">
          <span style="flex: 1 1 auto;"></span>
          <span>Inventory Gallery</span>
          <span style="flex: 1 1 auto;"></span>
        </mat-toolbar>

        <div class="mat-elevation-z22 tab-container">

          <app-announcement>

          </app-announcement>

          <br />
          <mat-divider></mat-divider>
          <br />

          <ng-container *ngIf="isLoadedTab == false">
            <br />
            <br />
            <br />
            <br />
            <mat-spinner style="margin: auto"></mat-spinner>
          </ng-container>

          <ng-container *ngIf="isLoadedTab == true">

            <div class="mat-elevation-z4 rounded-container-title">
              <h2 style="text-align: center; color: white">
                Inventory Gallery
              </h2>
            </div>

            <div class="mat-elevation-z4 control-container">

              <div style="display: flex; align-items: baseline">
                <span style="flex: 1 1 auto;"></span>
                <mat-form-field appearance="outline" style=" min-width: 50% ;flex:auto;border-radius: 16px !important">
                  <mat-label>Search</mat-label>

                  <input matInput placeholder="Ex. Juan De" (keyup)="applyFilterInv($event)">
                </mat-form-field>
                <span style="flex: 1 1 auto;"></span>

                <button mat-raised-button style="flex:auto; background-color: var(--danger-color)">View Archived <mat-icon>delete</mat-icon></button>&nbsp;

                <button mat-raised-button color="warn" class="control-button" style="flex:auto;" (click)="openDialogInvAdd()"> Add Item <mat-icon>add</mat-icon></button>&nbsp;

                <button mat-raised-button color="warn" class="control-button" style="flex:auto;" (click)="openDialogInvAddInvoice()"> Add Purchase Invoice <mat-icon>add</mat-icon></button>&nbsp;
                <span style="flex: 1 1 auto;"></span>

              </div>

              <!--<mat-paginator #empPaginator [pageSize]="10" [pageSizeOptions]="[10, 20, 100]"></mat-paginator>-->

            </div>

            <div class="mat-elevation-z4 rounded-container-flex">
              <br />
              <br />
              <mat-divider></mat-divider>
              <br />
              <div style="width: 100%; overflow-y: scroll; display: flex; flex-wrap:wrap; justify-content: center">

                <ng-container *ngFor="let element of inventoriesDataSource.data; index as i">

                  <div class="inv-box-container mat-elevation-z4" style="background-image: url(https://picsum.photos/200/300?random={{i}}); background-position: center; background-size: cover; opacity: .8">
                    <mat-chip-list>
                      <mat-chip color="primary" selected>{{element._id}}</mat-chip>
                    </mat-chip-list>

                    <button mat-fab color="warn"><p style="font-size: 12px;">{{element.inv_quantity}}/{{element.inv_min_amount}}</p></button>

                    <span style="flex: 1 1 auto;"></span>
                    <div style="flex: auto"><h4></h4></div>
                    <mat-chip-list>
                      <mat-chip color="accent" selected>{{element.inv_category}}</mat-chip>
                    </mat-chip-list>
                    <span style="flex: 1 1 auto;"></span>



                    <button mat-raised-button color="primary" (click)="openDialogInvEdit(element)"><mat-icon>visibility</mat-icon>&nbsp; View {{element.inv_name}}&nbsp; </button>
                  </div>

                </ng-container>

              </div>

            </div>

            <br />
            <br />
            <mat-divider></mat-divider>
            <br />

          </ng-container>

        </div>

      </mat-tab>

      <mat-tab>

        <ng-template mat-tab-label>

          <mat-icon>auto_awesome_mosaic</mat-icon>

          Inventory Table

        </ng-template>

        <mat-toolbar color="primary" class="mat-elevation-z22" style="z-index: 100;">
          <span style="flex: 1 1 auto;"></span>
          <span>Inventory Table</span>
          <span style="flex: 1 1 auto;"></span>
        </mat-toolbar>

        <div class="mat-elevation-z22 tab-container">

          <app-announcement>

          </app-announcement>

          <br />
          <mat-divider></mat-divider>
          <br />

          <ng-container *ngIf="isLoadedTab == false">
            <br />
            <br />
            <br />
            <br />
            <mat-spinner style="margin: auto"></mat-spinner>
          </ng-container>

          <ng-container *ngIf="isLoadedTab == true">

            <div class="mat-elevation-z4 rounded-container-title">
              <h2 style="text-align: center; color: white">
                Inventory Gallery
              </h2>
            </div>

            <div class="mat-elevation-z4 control-container">

              <div style="display: flex; align-items: baseline">
                <span style="flex: 1 1 auto;"></span>
                <mat-form-field appearance="outline" style=" min-width: 50% ;flex:auto;border-radius: 16px !important">
                  <mat-label>Search</mat-label>

                  <input matInput placeholder="Ex. Juan De" (keyup)="applyFilterInv($event)">
                </mat-form-field>
                <span style="flex: 1 1 auto;"></span>

                <button mat-raised-button color="primary" style="flex:auto">View Archived <mat-icon>recycling</mat-icon></button>&nbsp;

                <button mat-raised-button color="warn" class="control-button" style="flex:auto;"> Add Item <mat-icon>add</mat-icon></button>&nbsp;
                <span style="flex: 1 1 auto;"></span>

              </div>

              <mat-paginator #empPaginator [pageSize]="10" [pageSizeOptions]="[10, 20, 100]"></mat-paginator>

            </div>

            <div class="mat-elevation-z4 rounded-container-flex">

              <div style="width: 100%; overflow-x: scroll;">

                <mat-table [dataSource]="inventoriesDataSource" class="mat-elevation-z0" style="width: 100%" matSort>

                  <ng-container matColumnDef="name">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Name </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.inv_name}} </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="number" sticky>
                    <mat-header-cell *matHeaderCellDef> Number </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.inv_number}} </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="_id" sticky>
                    <mat-header-cell *matHeaderCellDef> Database ID </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element._id}} </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="id">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> ID </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.inv_id}} </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="description">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Description </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.inv_description}} </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="category">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Category </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.inv_category}} </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="quantity">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Quantity </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.inv_quantity}} </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="supplier">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Supplier </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.inv_supplier}} </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="min_amount">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Minimum Amount </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.inv_min_amount}} </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="price">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Price </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.inv_price}} </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="actions" stickyEnd>
                    <mat-header-cell *matHeaderCellDef> Actions </mat-header-cell>
                    <mat-cell *matCellDef="let element">

                      <button mat-raised-button color="accent"> Edit <mat-icon>visibility</mat-icon> </button>

                    </mat-cell>
                  </ng-container>
                  <mat-header-row *matHeaderRowDef="inventoriesDisplayedColumns"></mat-header-row>
                  <mat-row *matRowDef="let row; columns: inventoriesDisplayedColumns;"></mat-row>
                </mat-table>

              </div>

            </div>

            <br />
            <br />
            <mat-divider></mat-divider>
            <br />

          </ng-container>

        </div>

      </mat-tab>


    </mat-tab-group>






  </ng-container>

</ng-container>

<!--IF MOBILE-->

<!--<ng-container *ngIf="isMobile == true">

</ng-container>-->

 <!--ADD ITEM-->
<ng-template #invAddDialog let-data>
  <h2 matDialogTitle>New Item</h2>
  <mat-dialog-content style="display:flex; align-content:center; flex-wrap:wrap">

    <div style="width: 100%;">
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <mat-divider></mat-divider>
      <br />
    </div>

    <mat-form-field appearance="outline" style=" min-width: 40% ; flex:auto; border-radius: 16px !important">
      <mat-label>Image</mat-label>
      <ngx-mat-file-input [(ngModel)]="data.imageData" [ngStyle]="{'background-color': data.emp_invUrl? '' : 'var(--warn-lighter-color)'}">
      </ngx-mat-file-input>
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 20% ;flex:auto;border-radius: 16px !important">
      <mat-label>ID</mat-label>
      <input matInput type="text" [(ngModel)]="data.inv_id" [ngStyle]="{'background-color': data.inv_id? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 20% ;flex:auto;border-radius: 16px !important">
      <mat-label>Name</mat-label>
      <input matInput placeholder="Ex. Juan De" type="text" [(ngModel)]="data.name" [ngStyle]="{'background-color': data.name? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 20% ;flex:auto;border-radius: 16px !important">
      <mat-label>Category</mat-label>
      <input matInput placeholder="Ex. Sales" type="text" [(ngModel)]="data.category" [ngStyle]="{'background-color': data.category? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 40% ;flex:auto;border-radius: 16px !important">
      <mat-label>Price</mat-label>
      <input matInput placeholder="Ex. 22.00" type="number" [(ngModel)]="data.price" [ngStyle]="{'background-color': data.price? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 40% ;flex:auto;border-radius: 16px !important">
      <mat-label>Quantity</mat-label>
      <input matInput placeholder="Ex. 1" type="number" [(ngModel)]="data.quantity" [ngStyle]="{'background-color': data.quantity? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 40% ;flex:auto;border-radius: 16px !important">
      <mat-label>Minimum</mat-label>
      <input matInput placeholder="Ex. 1.00" type="number" [(ngModel)]="data.min_amount" [ngStyle]="{'background-color': data.min_amount? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 40% ;flex:auto;border-radius: 16px !important">
      <mat-label>Description</mat-label>
      <input matInput type="text" [(ngModel)]="data.description" [ngStyle]="{'background-color': data.description? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

  </mat-dialog-content>
  <mat-dialog-actions align="end">
    <button mat-raised-button matDialogClose color="primary" (click)="newInv(data)">Ok</button>
    <button mat-raised-button matDialogClose color="warn">Cancel</button>
  </mat-dialog-actions>
</ng-template>

 <!--ADD INVOICE-->

<ng-template #invAddInvoiceDialog let-data>
  <h2 matDialogTitle>New Purchase</h2>
  <mat-dialog-content style="display:flex; align-content:center; flex-wrap:wrap">

    <div style="width: 100%;">
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <mat-divider></mat-divider>
      <br />
    </div>

    <mat-form-field appearance="outline" style=" min-width: 20% ;flex:auto;border-radius: 16px !important">
      <mat-label>ID</mat-label>
      <input matInput type="text" [(ngModel)]="data.purc_id" [ngStyle]="{'background-color': data.inv_id? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 20% ;flex:auto;border-radius: 16px !important">
      <mat-label>Name</mat-label>
      <input matInput placeholder="Ex. Sales" type="text" [(ngModel)]="data.purc_name" [ngStyle]="{'background-color': data.category? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 20% ;flex:auto;border-radius: 16px !important">
      <mat-label>Purchase Date</mat-label>
      <input matInput [matDatepicker]="pickerCalendarDateStart" [(ngModel)]="data.purc_date" (dateInput)="loadTab(1)">
      <mat-hint>MM/DD/YYYY</mat-hint>
      <mat-datepicker-toggle matSuffix [for]="pickerCalendarDateStart">
        <mat-icon matDatepickerToggleIcon>keyboard_arrow_down</mat-icon>
      </mat-datepicker-toggle>
      <mat-datepicker #pickerCalendarDateStart></mat-datepicker>
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 80% ;flex:auto;border-radius: 16px !important">
      <mat-label>Reference ID</mat-label>
      <input matInput type="text" [(ngModel)]="data.purc_ref" [ngStyle]="{'background-color': data.description? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 80% ;flex:auto;border-radius: 16px !important">
      <mat-label>By</mat-label>
      <input matInput type="text" [(ngModel)]="data.purc_by" [ngStyle]="{'background-color': data.description? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 80% ;flex:auto;border-radius: 16px !important">
      <mat-label>Amount</mat-label>
      <input matInput type="number" [(ngModel)]="data.purc_amount" [ngStyle]="{'background-color': data.description? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 80% ;flex:auto;border-radius: 16px !important">
      <mat-label>Supplier</mat-label>
      <input matInput type="text" [(ngModel)]="data.purc_supplier" [ngStyle]="{'background-color': data.description? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

  </mat-dialog-content>
  <mat-dialog-actions align="end">
    <button mat-raised-button matDialogClose color="primary" (click)="newPurchase(data)">Ok</button>
    <button mat-raised-button matDialogClose color="warn">Cancel</button>
  </mat-dialog-actions>
</ng-template>



 <!--EDIT INV-->

<ng-template #invEditDialog let-data>
  <h2 matDialogTitle>{{data._id}}  &nbsp;|&nbsp; {{data.inv_name}} &nbsp; valued at  &nbsp; {{data.inv_quantity * data.inv_price}} &nbsp; </h2>
  <mat-dialog-content style="display:flex; align-content:center; flex-wrap:wrap">

    <div style="width: 100%;">
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <mat-divider></mat-divider>
      <br />
    </div>

    <mat-form-field appearance="outline" style=" min-width: 40% ; flex:auto; border-radius: 16px !important">
      <mat-label>Image</mat-label>
      <ngx-mat-file-input [(ngModel)]="data.inv_imgUrl" [ngStyle]="{'background-color': data.inv_imgUrl? '' : 'var(--warn-lighter-color)'}">
      </ngx-mat-file-input>
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 20% ;flex:auto;border-radius: 16px !important">
      <mat-label>ID</mat-label>
      <input matInput type="text" [(ngModel)]="data.inv_id" [ngStyle]="{'background-color': data.inv_id? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 20% ;flex:auto;border-radius: 16px !important">
      <mat-label>Name</mat-label>
      <input matInput placeholder="Ex. Juan De" type="text" [(ngModel)]="data.inv_name" [ngStyle]="{'background-color': data.inv_name? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 20% ;flex:auto;border-radius: 16px !important">
      <mat-label>Category</mat-label>
      <input matInput placeholder="Ex. Sales" type="text" [(ngModel)]="data.inv_category" [ngStyle]="{'background-color': data.inv_category? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 20% ;flex:auto;border-radius: 16px !important">
      <mat-label>Supplier</mat-label>
      <input matInput placeholder="Ex. Juan De" type="text" [(ngModel)]="data.inv_supplier" [ngStyle]="{'background-color': data.inv_supplier? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 40% ;flex:auto;border-radius: 16px !important">
      <mat-label>Price</mat-label>
      <input matInput required placeholder="Ex. 22.00" type="number" [(ngModel)]="data.inv_price" [ngStyle]="{'background-color': data.inv_price? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 40% ;flex:auto;border-radius: 16px !important">
      <mat-label>Quantity</mat-label>
      <input matInput required placeholder="Ex. 1" type="number" [(ngModel)]="data.inv_quantity" [ngStyle]="{'background-color': data.inv_quantity? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 40% ;flex:auto;border-radius: 16px !important">
      <mat-label>Minimum</mat-label>
      <input matInput placeholder="Ex. 1.00" type="number" [(ngModel)]="data.inv_min_amount" [ngStyle]="{'background-color': data.inv_min_amount? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <mat-form-field appearance="outline" style=" min-width: 80% ;flex:auto;border-radius: 16px !important">
      <mat-label>Description</mat-label>
      <input matInput type="text" [(ngModel)]="data.inv_description" [ngStyle]="{'background-color': data.inv_description? '' : 'var(--warn-lighter-color)'}">
    </mat-form-field>&nbsp;

    <div style="width: 100%;">
      <br />
      <mat-divider></mat-divider>
      <br />
    </div>

    <div style="width: 100%; display: flex; align-items: flex-start; align-content:baseline">

      <h4 style="max-width: 20% ;flex:auto">Sell Item</h4>
      <span style="flex: 1 1 auto;"></span>
      
      <mat-form-field appearance="outline" style="min-width: 20% ;flex:auto;border-radius: 16px !important">
        <mat-label>Sale Quantity</mat-label>
        <input matInput required placeholder="1" type="number" value="0" [(ngModel)]="data.sale_quantity" [ngStyle]="{'background-color': data.quantity? '' : 'var(--warn-lighter-color)'}">
      </mat-form-field>&nbsp;
      <mat-form-field appearance="outline" style="min-width: 20% ;flex:auto;border-radius: 16px !important">
        <mat-label>Sale Price</mat-label>
        <input matInput required placeholder="1" type="number" [(ngModel)]="data.sale_price" [ngStyle]="{'background-color': data.quantity? '' : 'var(--warn-lighter-color)'}">
      </mat-form-field>&nbsp;

      &nbsp;&nbsp;&nbsp;

      <h5 style="max-width: 20% ;flex:auto">Amount After Sale : {{data.inv_quantity - data.sale_quantity}}</h5>&nbsp;
      <span style="flex: 1 1 auto;"></span>
      <h3 style="max-width: 20% ;flex:auto">Total : PHP&nbsp; {{data.sale_quantity * data.sale_price}}</h3>
      <button style="max-width: 20% ;flex:auto" mat-raised-button matDialogClose color="primary" (click)="addSale(data)">Add Sale</button>

    </div>

     <div style="width: 100%;">
      <br />
      <mat-divider></mat-divider>
      <br />
    </div>

    <div style="width: 100%; display: flex; align-items: flex-start; align-content:baseline">

      <h4 style="max-width: 20% ;flex:auto">Restock Item</h4>
      <span style="flex: 1 1 auto;"></span>
      <mat-form-field appearance="outline" style=" min-width: 20% ;flex:auto;border-radius: 16px !important">
        <mat-label>Purchase Quantity</mat-label>
        <input matInput required placeholder="1" type="number" value="0" [(ngModel)]="data.purc_quantity" [ngStyle]="{'background-color': data.quantity? '' : 'var(--warn-lighter-color)'}">
      </mat-form-field>&nbsp;
      <mat-form-field appearance="outline" style="min-width: 20% ;flex:auto;border-radius: 16px !important">
        <mat-label>Purchase Price</mat-label>
        <input matInput required placeholder="1" type="number"[(ngModel)]="data.purc_price" [ngStyle]="{'background-color': data.quantity? '' : 'var(--warn-lighter-color)'}">
      </mat-form-field>&nbsp;
      &nbsp;&nbsp;&nbsp;



      <h5 style="max-width: 20% ;flex:auto">Amount After Purchase : {{data.inv_quantity + data.purc_quantity}}</h5>&nbsp;
      <span style="flex: 1 1 auto;"></span>
      <h3 style="max-width: 20% ;flex:auto">Total : PHP&nbsp;  {{data.purc_quantity * data.purc_price}}</h3>
      <button style="max-width: 20% ;flex:auto" mat-raised-button matDialogClose color="primary" >Add Purchase</button>

    </div>



  </mat-dialog-content>
  <mat-dialog-actions align="end">

    
    <button mat-raised-button matDialogClose color="warn" (click)="editInv(data)">Ok</button>
    <button mat-raised-button matDialogClose color="warn">Cancel</button>
  </mat-dialog-actions>
</ng-template>

